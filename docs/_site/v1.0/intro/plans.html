<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <meta name="Description" content="Blip is the most advanced MySQL metrics collector ever built."> <title>Plans - Blip</title> <link rel="stylesheet" href="/blip/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/blip/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/blip/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="/blip/" class="site-title lh-tight"> Blip </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/blip/" class="nav-list-link">Home</a></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/blip/v1.0/intro/" class="nav-list-link">Introduction</a><ul class="nav-list "><li class="nav-list-item "><a href="/blip/v1.0/intro/concepts" class="nav-list-link">Blip</a></li><li class="nav-list-item "><a href="/blip/v1.0/intro/sinks" class="nav-list-link">Sinks</a></li><li class="nav-list-item "><a href="/blip/v1.0/intro/monitors" class="nav-list-link">Monitors</a></li><li class="nav-list-item active"><a href="/blip/v1.0/intro/plans" class="nav-list-link active">Plans</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/blip/v1.0/quick-start/" class="nav-list-link">Quick Start</a><ul class="nav-list "><li class="nav-list-item "><a href="/blip/v1.0/quick-start/laptop" class="nav-list-link">Laptop</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/blip/v1.0/config/" class="nav-list-link">Configure</a><ul class="nav-list "><li class="nav-list-item "><a href="/blip/v1.0/config/blip" class="nav-list-link">Blip</a></li><li class="nav-list-item "><a href="/blip/v1.0/config/config-file" class="nav-list-link">Config File</a></li><li class="nav-list-item "><a href="/blip/v1.0/config/quick-ref" class="nav-list-link">Quick Reference</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/blip/v1.0/plans/" class="nav-list-link">Plans</a><ul class="nav-list "><li class="nav-list-item "><a href="/blip/v1.0/plans/defaults" class="nav-list-link">Defaults</a></li><li class="nav-list-item "><a href="/blip/v1.0/plans/file" class="nav-list-link">File</a></li><li class="nav-list-item "><a href="/blip/v1.0/plans/table" class="nav-list-link">Table</a></li><li class="nav-list-item "><a href="/blip/v1.0/plans/scope" class="nav-list-link">Scope</a></li><li class="nav-list-item "><a href="/blip/v1.0/plans/quick-ref" class="nav-list-link">Quick Reference</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/blip/v1.0/metrics/" class="nav-list-link">Metrics</a><ul class="nav-list "><li class="nav-list-item "><a href="/blip/v1.0/metrics/defaults" class="nav-list-link">Defaults</a></li><li class="nav-list-item "><a href="/blip/v1.0/metrics/collecting" class="nav-list-link">Collecting</a></li><li class="nav-list-item "><a href="/blip/v1.0/metrics/reporting" class="nav-list-link">Reporting</a></li><li class="nav-list-item "><a href="/blip/v1.0/metrics/domains" class="nav-list-link">Domains</a></li><li class="nav-list-item "><a href="/blip/v1.0/metrics/collectors" class="nav-list-link">Collectors</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/blip/v1.0/sinks/" class="nav-list-link">Sinks</a><ul class="nav-list "><li class="nav-list-item "><a href="/blip/v1.0/sinks/chronosphere" class="nav-list-link">chronosophere</a></li><li class="nav-list-item "><a href="/blip/v1.0/sinks/log" class="nav-list-link">log</a></li><li class="nav-list-item "><a href="/blip/v1.0/sinks/retry" class="nav-list-link">retry</a></li><li class="nav-list-item "><a href="/blip/v1.0/sinks/signalfx" class="nav-list-link">signalfx</a></li><li class="nav-list-item "><a href="/blip/v1.0/sinks/custom" class="nav-list-link">Custom</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/blip/v1.0/api/" class="nav-list-link">API</a><ul class="nav-list "><li class="nav-list-item "><a href="/blip/v1.0/api/server" class="nav-list-link">Server</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/blip/v1.0/cloud/" class="nav-list-link">Cloud</a><ul class="nav-list "><li class="nav-list-item "><a href="/blip/v1.0/cloud/aws" class="nav-list-link">AWS</a></li></ul></li><li class="nav-list-item"><a href="/blip/v1.0/heartbeat" class="nav-list-link">Heartbeat</a></li><li class="nav-list-item"><a href="/blip/v1.0/prometheus" class="nav-list-link">Prometheus</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/blip/v1.0/monitor/" class="nav-list-link">Monitor</a><ul class="nav-list "><li class="nav-list-item "><a href="/blip/v1.0/monitor/engine" class="nav-list-link">Engine</a></li><li class="nav-list-item "><a href="/blip/v1.0/monitor/level-adjuster" class="nav-list-link">Level Plan Adjuster</a></li><li class="nav-list-item "><a href="/blip/v1.0/monitor/level-collector" class="nav-list-link">Level Plan Collector</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/blip/v1.0/server/" class="nav-list-link">Server</a><ul class="nav-list "><li class="nav-list-item "><a href="/blip/v1.0/server/core" class="nav-list-link">Blip</a></li><li class="nav-list-item "><a href="/blip/v1.0/server/plan-loader" class="nav-list-link">Plan Loader</a></li><li class="nav-list-item "><a href="/blip/v1.0/server/monitor-loader" class="nav-list-link">Monitor Loader</a></li><li class="nav-list-item "><a href="/blip/v1.0/server/db-maker" class="nav-list-link">Db Maker</a></li></ul></li><li class="nav-list-item"><a href="/blip/v1.0/integrate" class="nav-list-link">Integrate</a></li><li class="nav-list-item"><a href="/blip/release-notes" class="nav-list-link">Release Notes</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Blip" aria-label="Search Blip" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="//github.com/cashapp/blip" class="site-button" > Blip </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/blip/v1.0/intro/">Introduction</a></li> <li class="breadcrumb-nav-list-item"><span>Plans</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h1 id="plans"> <a href="#plans" class="anchor-heading" aria-labelledby="plans"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Plans </h1> <p>A <em>level plan</em> (or <em>plan</em> for short) configures which metrics to collect. Plans solve three problems:</p> <ul> <li>Which metrics to collect?</li> <li>How to collect those metrics?</li> <li>How <em>often</em> to collect those metrics?</li> </ul> <p>The first problem arises because there are over 1,000 MySQL metrics but 0 standards for which metrics to collect. Some engineers collect nearly all metrics and use what they need in graphs. Some engineers collect as few metrics as possible due to costs. Some engineers don’t know what to collect, relying on monitor defaults to be useful.</p> <p>Plans help solve the first problem by not hard-coding which metrics to collect. Write a plan to collect only the metrics you need.</p> <div class="note"> Blip has a built-in default plan that collects more than 60 of the most important MySQL metrics, which might be all you need. </div> <p>The second problem arises because there are many versions and distributions of MySQL, which makes some metrics a moving target. For example: where do you collect a MySQL replication lag metric? The oldest and perhaps still most common source is <code class="language-plaintext highlighter-rouge">Seconds_Behind_Master</code> in the <code class="language-plaintext highlighter-rouge">SHOW SLAVE STATUS</code> output. But those two changed to <code class="language-plaintext highlighter-rouge">Seconds_Behind_Source</code> and <code class="language-plaintext highlighter-rouge">SHOW REPLICA STATUS</code>, respectively. And what if you don’t use those and, instead, use <a href="https://www.percona.com/doc/percona-toolkit/LATEST/pt-heartbeat">pt-heartbeat</a> or the Blip built-in heartbeat? Or what if you’re running <a href="https://dev.mysql.com/doc/refman/8.0/en/group-replication">MySQL Group Replication</a>? Or what if you run MySQL in the cloud and the cloud provider emits its own replication lag metric?</p> <p>Plans help solve the second problem by using <em>metric domains</em> (or <em>domains</em> for short) to name logically-related group of MySQL metrics. Probably the most well known group is <code class="language-plaintext highlighter-rouge">SHOW GLOBAL STATUS</code>, to which Blip gives the domain name <code class="language-plaintext highlighter-rouge">status.global</code>. A replication lag metric is scoped within the <code class="language-plaintext highlighter-rouge">repl</code> domain (short for “replication”), which hides (abstarcts way) the technical details of how it’s collected. When you write a plan that collects replication lag, the plan works everywhere because domains specify <em>which</em> metrics to collect, not necessarily <em>how</em> to collect them.</p> <p>The third problem arises from cost and storage limits: if everything was fast and free, you would collect all metrics every 1 second. But this is (almost) never done because it requires significant storage and processing, which lead to significant costs. Instead, the norm is collecting all metrics every 10, 20, or 30 seconds. But even 10 seconds is too long for a busy database because, for example, at only 5,000 QPS, that resolution averages out the metrics for 50,000 queries.</p> <p>Plans help solve the third problem by allowing you to collect different metrics at different frequencies—which is the “level” in the full term: “level plan”. It helps to remember as: “Higher the level, higher the wait (time between collection).” For example, imagine three levels as shown below.</p> <p><img src="/blip/assets/img/three-levels.png" alt="Three Levels" /></p> <p>Level 1, the base level, is collected frequently (shortest wait time): every 5 seconds. Level 2 is collected less frequently: every 20 seconds. Level 3, the highest level, is collected the most infrequently (longest wait time): every 30 seconds.</p> <p>Blip automatically combines levels when they overlap and collects all metrics at that time.</p> <p><img src="/blip/assets/img/level-times.png" alt="Three Levels" /></p> <p>At 20 seconds (since Blip started collecting metrics for this plan), Blip collects metrics for both levels 1 and 2 because <code class="language-plaintext highlighter-rouge">20 mod 5 = 0</code> and <code class="language-plaintext highlighter-rouge">20 mod 20 = 0</code>, respectively. At 30 seconds, Blip collects metrics for both levels 1 and 3 because <code class="language-plaintext highlighter-rouge">30 mod 5 = 0</code> and <code class="language-plaintext highlighter-rouge">30 mod 20 = 0</code>, respectively. And at 60 seconds, Blip collects metrics for all three levels because <code class="language-plaintext highlighter-rouge">60 mod freq = 0</code>.</p> <p>Blip plans can do more, but for this introduction it’s sufficient to know that they allow you to fine-tune metrics collection, which increases the quality of monitoring while reducing costs.</p><hr /> <p>Keep going: <a href="../quick-start/">Quick Start ↓</a></p> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
