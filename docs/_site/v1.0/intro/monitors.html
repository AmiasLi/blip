<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <meta name="Description" content="Blip is a MySQL metrics collector."> <title>Monitors - Blip</title> <link rel="stylesheet" href="/blip/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/blip/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/blip/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="/blip/" class="site-title lh-tight"> Blip </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/blip/" class="nav-list-link">Home</a></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/blip/v1.0/intro" class="nav-list-link">Introduction</a><ul class="nav-list "><li class="nav-list-item "><a href="/blip/v1.0/intro/concepts.html" class="nav-list-link">Blip</a></li><li class="nav-list-item "><a href="/blip/v1.0/intro/sinks.html" class="nav-list-link">Sinks</a></li><li class="nav-list-item active"><a href="/blip/v1.0/intro/monitors.html" class="nav-list-link active">Monitors</a></li><li class="nav-list-item "><a href="/blip/v1.0/intro/plans.html" class="nav-list-link">Plans</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/blip/v1.0/quick-start" class="nav-list-link">Quick Start</a><ul class="nav-list "><li class="nav-list-item "><a href="/blip/v1.0/quick-start/laptop.html" class="nav-list-link">Laptop</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/blip/v1.0/config" class="nav-list-link">Configure</a><ul class="nav-list "><li class="nav-list-item "><a href="/blip/v1.0/config/blip.html" class="nav-list-link">Blip</a></li><li class="nav-list-item "><a href="/blip/v1.0/config/config-file.html" class="nav-list-link">Config File</a></li><li class="nav-list-item "><a href="/blip/v1.0/config/quick-ref.html" class="nav-list-link">Quick Reference</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/blip/v1.0/plans" class="nav-list-link">Plans</a><ul class="nav-list "><li class="nav-list-item "><a href="/blip/v1.0/plans/quick-ref.html" class="nav-list-link">Quick Reference</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/blip/v1.0/metrics" class="nav-list-link">Metrics</a><ul class="nav-list "><li class="nav-list-item "><a href="/blip/v1.0/metrics/domains.html" class="nav-list-link">Domains</a></li><li class="nav-list-item "><a href="/blip/v1.0/metrics/collectors.html" class="nav-list-link">Collectors</a></li><li class="nav-list-item "><a href="/blip/v1.0/metrics/sinks.html" class="nav-list-link">Sinks</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/blip/v1.0/api" class="nav-list-link">API</a><ul class="nav-list "><li class="nav-list-item "><a href="/blip/v1.0/api/endpoints.html" class="nav-list-link">Endpoints</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/blip/v1.0/cloud" class="nav-list-link">Cloud</a><ul class="nav-list "><li class="nav-list-item "><a href="/blip/v1.0/cloud/aws.html" class="nav-list-link">AWS</a></li></ul></li><li class="nav-list-item"><a href="/blip/v1.0/heartbeat" class="nav-list-link">Heartbeat</a></li><li class="nav-list-item"><a href="/blip/v1.0/prometheus" class="nav-list-link">Prometheus</a></li><li class="nav-list-item"><a href="/blip/release-notes" class="nav-list-link">Release Notes</a></li><li class="nav-list-item"><a href="/blip/v1.0/integrate" class="nav-list-link">Integrate</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Blip" aria-label="Search Blip" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="//github.com/cashapp/blip" class="site-button" > Blip </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/blip/v1.0/intro">Introduction</a></li> <li class="breadcrumb-nav-list-item"><span>Monitors</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h1 id="monitors"> <a href="#monitors" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Monitors </h1> <p>Every MySQL instance that Blip monitors is called a <em>moniotr</em>. For simplicity, the terms <em>monitor</em> and <em>MySQL instance</em> are synonymous because a monitor requires and represents only one MySQL instance. But there is more to a monitor than its MySQL instance.</p> <div class="note"> <b>NOTE</b>: <em>Monitor</em> and <em>MySQL instance</em> are synonymous in Blip. </div> <p>Monitors are usually specififed in the <a href="../config/config-file">Blip config file</a>, but they can be loaded various ways—more on this later. For now, it’s only necessary to know that monitors are listed in the YAML config file under the aptly named section <code class="language-plaintext highlighter-rouge">moniotrs</code>. The most basic Blip monitor is a simple hostname, username, and password:</p> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">monitors</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">hostname</span><span class="pi">:</span> <span class="s">127.0.0.1</span>
    <span class="na">username</span><span class="pi">:</span> <span class="s">blip</span>
    <span class="na">password</span><span class="pi">:</span> <span class="s">aStrongRandomPassword</span>
</code></pre></div></div> <p>Or, if you want to use a <code class="language-plaintext highlighter-rouge">my.cnf</code> file:</p> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">monitors</span><span class="pi">:</span>
  <span class="pi">-</span>  <span class="na">mycnf</span><span class="pi">:</span> <span class="s">${HOME}/.my.cnf</span>
</code></pre></div></div> <p>A single Blip instances can monitor any number of MySQL instances. Here is a snippet of config that specifies three different MySQL instances:</p> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">monitors</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">socket</span><span class="pi">:</span> <span class="s">/tmp/mysql.sock</span>
    <span class="na">username</span><span class="pi">:</span> <span class="s">blip</span>
    <span class="na">password-file</span><span class="pi">:</span> <span class="s">/dev/shm/metrics-password</span>
  <span class="pi">-</span> <span class="na">hostname</span><span class="pi">:</span> <span class="s">10.1.1.53</span>
    <span class="na">username</span><span class="pi">:</span> <span class="s">metrics</span>
    <span class="na">password</span><span class="pi">:</span> <span class="s">foo</span>
  <span class="pi">-</span> <span class="na">hostname</span><span class="pi">:</span> <span class="s">db3.us-east-1.amazonaws.com</span>
    <span class="na">aws-rds</span><span class="pi">:</span>
      <span class="na">auth-token</span><span class="pi">:</span> <span class="no">true</span>
</code></pre></div></div> <p>The first instance is local: Blip connects using socket file <code class="language-plaintext highlighter-rouge">/tmp/mysql.sock</code>. The second instance is remote: Blip connects to IP <code class="language-plaintext highlighter-rouge">10.1.1.53</code>. The third instance is an Amazon RDS for MySQL instance, and Blip uses <a href="https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/UsingWithRDS.IAMDBAuth.html">IAM authentication</a>.</p> <p>The point of these contrived examples is: Blip can monitor <em>any</em> MySQL instance anywhere it’s running. (If you have a case where this is not true, please file an issue.)</p> <p>By default, Blip first attempts to load monitors from its config file (which is <code class="language-plaintext highlighter-rouge">blip.yaml</code> in the current working directory, by default). But the config file can specify other ways to load monitors:</p> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">monitor-loader</span><span class="pi">:</span>
  <span class="na">freq</span><span class="pi">:</span> <span class="s">60s</span>
  <span class="na">files</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">monitors1.yaml</span><span class="pi">,</span> <span class="nv">monitors2.yaml</span><span class="pi">]</span>
</code></pre></div></div> <p>In short, that config snippet makes Blip load (read) monitor configuration from files <code class="language-plaintext highlighter-rouge">monitors1.yaml</code> and <code class="language-plaintext highlighter-rouge">monitors2.yaml</code> every 60 seconds. (Blip can dynamically load [add] and unload [remove] monitors while running.) The <code class="language-plaintext highlighter-rouge">monitor-load</code> config is optional; by default, Blip loads monitors from the <code class="language-plaintext highlighter-rouge">monitors</code> section in its config file.</p> <p>To further ensure that Blip can monitory <em>any</em> MySQL instance, loading monitors is an optional plugin with this callback signature:</p> <div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">LoadMonitors</span> <span class="k">func</span><span class="p">(</span><span class="n">Config</span><span class="p">)</span> <span class="p">([]</span><span class="n">ConfigMonitor</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
</code></pre></div></div> <p>Hopefully, bilt-in features cover every use case, but if you have particular requirements (filtering out certain MySQL instances, for example), you can plug in your own code to load monitors.</p> <p>In addition to basic MySQL configuration—how to connect to MySQL: hostname, username, and password, and so forth—monitors have other optional features and configuration, summarized briefly in the following table.</p> <div class="table-wrapper"><table> <thead> <tr> <th>Monitor Confg</th> <th>Feature</th> </tr> </thead> <tbody> <tr> <td><code class="language-plaintext highlighter-rouge">aws</code></td> <td>Amazon RDS authentication</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">exporter</code></td> <td>Prometheus mysqld_exporter emulation</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">ha</code></td> <td>High availability (not implemented yet)</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">heartbeat</code></td> <td>Heartbeat to measure replication lag</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">meta</code></td> <td>User-defined key-value data</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">plans</code></td> <td>Monitor-specific plans for metrics collection</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">sinks</code></td> <td>Monitors-specific sinks for sending metrics</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">tags</code></td> <td>Monitor-specific key-value data passed to sinks</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">tls</code></td> <td>TLS configuration</td> </tr> </tbody> </table></div> <p>That’s a lot of information, but the point is a lot simpler: Blip monitors can do almost anything. For the most part, these features support Blip in large, automated environments. If you don’t need a feature, you can forget about it: Blip is simple (and fully automatic) by default. When you need a feature, Blip most likely already supports it.</p> <p>One last helpful tip:</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>blip <span class="nt">--print-moniotrs</span> <span class="nt">--run</span><span class="o">=</span><span class="nb">false</span>
</code></pre></div></div> <p>The command line above starts (but does not run) Blip so that it loads monitors and prints them, then exists. This can help debug monitor loading and configuration.</p> <hr /> <p>Keep learning: <a href="plans">Plans ↓</a></p> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
